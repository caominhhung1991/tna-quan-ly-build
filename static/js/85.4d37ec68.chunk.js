(this["webpackJsonpreact-antd-admin"]=this["webpackJsonpreact-antd-admin"]||[]).push([[85],{1117:function(e,n,t){"use strict";t.r(n);var a=t(13),i=t(8),c=t(21),u=t(33),o=t(0),r=t.n(o),d=t(48),l=t(201),s=t(202),b=t(271),g=t(415),h=t(158),j=t(272),O=t(6),p=t(278),v=t(825),f=t(377),m=t(178),y={getTableColumns:function(){return[Object(i.a)(Object(i.a)({},O.constants.stt),{},{fixed:!1}),f.c.tenNguyenLieu,Object(i.a)(Object(i.a)({},p.a.tenDonViTinh),{},{align:"center"}),m.a.tenNhomNguyenLieu,Object(i.a)(Object(i.a)({},v.a.tenNhaCungCap),{},{fixed:!1,name:"T\xean NCC \u0111\u1eb7t h\xe0ng",width:150}),Object(i.a)(Object(i.a)({},f.c.giaNguyenLieu),{},{name:"Gi\xe1 \u0111\u1eb7t h\xe0ng"}),O.constants.active,O.constants.editRow]},getInputFields:function(){return[]},getExcelFields:function(){return[O.constants.id,f.c.tenNguyenLieu,p.a.tenDonViTinh,m.a.nhomNguyenLieuId,m.a.tenNhomNguyenLieu,v.a.nhaCungCapId,v.a.tenNhaCungCap,f.c.giaNguyenLieu]}},C=t(416),N=t(806),L=t(204),D=t(422),I=t(35),w=t(417),x=t(71),S=t(3),T=t.n(S),k=t(9),V=t(559),P=t(66),F=t(177),R=t(75),A=t(15),M=t(421),E=t(418),B=t(936),z=t(444),G=t(147);var K=t(179),J=t(17),X=h.d.nguyenLieuModal,Q=function(e){var n,t,o=e.pageDatas,l=Object(d.b)(),b=Object(d.c)((function(e){return e.account})).isDev,j=Object(d.c)((function(e){return e.diaDiem})),p=j.diaDiemId,v=j.diaDiems,f=Object(d.c)((function(e){return e.nhaCungCap})),m=f.nhaCungCapId,y=f.nhaCungCaps,C=Object(d.c)((function(e){return e.table})).selectedRows,N=Object(F.useForm)(),D=Object(u.a)(N,1)[0],w=0!==((null===C||void 0===C?void 0:C[X])||[]).length,x=Object(d.c)((function(e){return e.account})).accountData,S=null===x||void 0===x||null===(n=x.paths)||void 0===n||null===(t=n.danhSachNL)||void 0===t?void 0:t.edit;function Q(){return(Q=Object(k.a)(T.a.mark((function e(){var n,t,a,i,c;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(null===v||void 0===v?void 0:v[p])||{},t=n.tenDiaDiem,a=(null===y||void 0===y?void 0:y[m])||{},i=a.tenNhaCungCap,S){e.next=4;break}return e.abrupt("return",Object(I.h)());case 4:if(window.confirm("X\xe1c nh\u1eadn c\u1eadp nh\u1eadt c\xe1c nguy\xean li\xeau th\xe0nh nh\xe0 cung c\u1ea5p ".concat(i," \u0111ang \u0111\u1eb7t h\xe0ng t\u1ea1i \u0111\u1ecba \u0111i\u1ec3m ").concat(t))){e.next=6;break}return e.abrupt("return");case 6:return Object(A.l)("giaNguyenLieuTheoDiaDiem"),c=(null===C||void 0===C?void 0:C[X])||[],e.next=10,Promise.all(c.map((function(e){var n={id:e.id,nhaCungCapId:m};return n=l(Object(M.c)(n)),l(Object(z.h)(n,p))})));case 10:l(Object(s.d)({tableId:X,selectedRowKeys:[],selectedRows:[]})),l(Object(z.d)(p)),Object(I.g)();case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.useEffect((function(){l(Object(z.d)(p))}),[p]),r.a.useEffect((function(){var e=localStorage.getItem("nhaCungCapId")||"",n=(null===K.a||void 0===K.a?void 0:K.a.chiMotDiaDiem)?K.a.diaDiemId:localStorage.getItem("diaDiemId")||"";l(Object(M.a)(e)),l(Object(E.a)(n)),D.setFieldsValue({nhaCungCapId:e,diaDiemId:n})}),[]),Object(J.b)(J.a,{children:Object(J.b)(g.a,{header:Object(J.b)("div",{className:"font-weight-bold",children:Object(J.b)("span",{children:"Th\xf4ng Tin Trang"})}),body:Object(J.c)("div",{className:"form-input-aside",style:{padding:"5px"},children:[Object(J.b)(V.a,{form:D,children:Object(J.b)(B.a,{isAddNew:!0,isTrangQuanLy:!0,diaDiemId:p,onAfterAddFinish:function(e){D.setFieldsValue({nhaCungCapId:e})}})}),Object(J.b)("div",{style:{marginTop:"10px"},children:Object(J.b)(P.a,{disabled:!w,type:"primary",onClick:function(){return Q.apply(this,arguments)},children:"C\u1eadp nh\u1eadt nh\xe0 cung c\u1ea5p"})}),b&&Object(J.b)("div",{style:{marginTop:"10px"},children:Object(J.b)(P.a,{onClick:function(){l(function(){var e=Object(k.a)(T.a.mark((function e(n,t){var c,u,o,r,d,l,s;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t(),u=c.nguyenLieu.nguyenLieus,o=new G.a,r=o.nhomGiaMonAnPaths,e.next=6,Object(A.d)(r);case 6:return d=e.sent,l=Object.values(d).reduce((function(e,n){return Object.values(n).reduce((function(e,n){return n.reduce((function(e,n){var t,c=n.id,o=(null===u||void 0===u||null===(t=u[c])||void 0===t?void 0:t.tenNguyenLieu)||c;return Object(i.a)(Object(i.a)({},e),{},Object(a.a)({},c,o))}),e)}),e)}),{}),s=o.nguyenLieuDaSuDungPaths,e.next=11,n(Object(A.i)(s));case 11:return e.next=13,n(Object(A.n)(s,l));case 13:Object(O.thongBaoDaLuu)();case 14:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}())},children:"L\u01b0u NL \u0111\xe3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong m\xf3n \u0103n"})}),b&&Object(J.b)("div",{style:{marginTop:"10px"},children:Object(J.b)(P.a,{onClick:function(){l(function(e){return function(){var n=Object(k.a)(T.a.mark((function n(t,a){var i,u,o,r,d;return T.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=a(),(u=i.nguyenLieu).nguyenLieuDaSuDungs,o=u.nguyenLieus,console.log(Object.values(o)),r=Object.values(o||{}).map((function(e){var n,t=e.id,a=e.active,i=e.tenNguyenLieu,c=e.donViTinhId,u=e.tenDonViTinh,o=e.nhomNguyenLieuId,r=e.tenNhomNguyenLieu,d=i.toLowerCase();return(null===(n=d=d.split(""))||void 0===n?void 0:n[0])&&(d[0]=d[0].toUpperCase()),{id:t,active:a,tenNguyenLieu:d=d.join(""),donViTinhId:c,tenDonViTinh:u,nhomNguyenLieuId:o,tenNhomNguyenLieu:r}})),d=new L.a,Object.values(e).filter((function(e){return!(null===e||void 0===e?void 0:e.isDaSuDung)&&"giaVi"!==e.nhomNguyenLieuId&&"chiPhiKhac"!==e.nhomNguyenLieuId&&"dien"!==e.nhomNguyenLieuId&&"gas"!==e.nhomNguyenLieuId})),n.next=8,Promise.all(r.map((function(e){var n=[].concat(Object(c.a)(d.pathDatas),[e.id]);return Object(A.j)(n,e)})));case 8:Object(O.thongBaoDaLuu)();case 9:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()}(o))},children:"X\xf3a NL kh\xf4ng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong m\xf3n \u0103n"})})]}),footer:Object(J.b)("div",{children:Object(J.b)(P.a,{icon:Object(J.b)(R.a,{}),onClick:function(){return l(Object(O.toggleAside)({tagPageId:h.d.nguyenLieuModal}))},children:"\u0110\xf3ng m\u1edf r\u1ed9ng"})})})})},U=t(790),q=h.d.nguyenLieuModal;n.default=function(){var e,n,t=Object(d.b)(),o=Object(d.c)((function(e){return e.nguyenLieu})),h=o.tabsData,p=o.loading,v=o.pageSize,f=o.nguyenLieus,m=o.nguyenLieuDaSuDungs,S=Object(d.c)((function(e){return e.nhaCungCap})).nhaCungCaps,T=Object(d.c)((function(e){return e.danhSachGiaNL})).giaNguyenLieuTheoDiaDiemDatas,k=Object(d.c)((function(e){var n;return null===(n=e.tagsPage)||void 0===n?void 0:n[q]})),P=Object(d.c)((function(e){return e.account})).accountData,F=null===P||void 0===P||null===(e=P.paths)||void 0===e||null===(n=e.danhSachNL)||void 0===n?void 0:n.edit,R=V.a.useForm(),A=Object(u.a)(R,1)[0],E=Object(b.a)({Instance:L.a,onPending:D.i,addSelectedId:D.a,isEdit:F}),B=(null===K.a||void 0===K.a?void 0:K.a.chiMotDiaDiem)?[]:[{label:Object(J.b)(V.a,{form:A,children:Object(J.b)(U.a,{style:{width:220},isDanhSachNL:!0,onAfterSelect:function(e){A.setFieldsValue({nhaCungCapId:""}),t(Object(M.a)(""))}})}),value:"diaDiemSelect"}],z=[O.constantTabs.moRong].concat(B,Object(c.a)(h));var G=r.a.useMemo((function(){return Object.values(f).reduce((function(e,n){var t=n.id,c=!!(null===m||void 0===m?void 0:m[t]),u=(null===T||void 0===T?void 0:T[t])||{},o=u.tenNhaCungCap,r=u.nhaCungCapId,d=u.giaNguyenLieu;if(d&&!o){var l=(null===S||void 0===S?void 0:S[r])||{};console.log(n.tenNguyenLieu,r,l.tenNhaCungCap)}var s=Object(i.a)(Object(i.a)({},n),{},{nhaCungCapId:r,tenNhaCungCap:o,giaNguyenLieu:d,isDaSuDung:c});return Object(i.a)(Object(i.a)({},e),{},Object(a.a)({},t,s))}),{})}),[f,T,m]);return Object(J.c)("div",{className:"nguyenLieu-page",css:j.a,children:[Object(J.b)(g.b,{className:"tabs",options:z,activeKey:k?"aside":"",onTabClick:function(e){if("add"===e){if(!F)return Object(I.h)();var n=new L.a;t(Object(l.c)({modalId:q,data:n.initData}))}else"aside"===e?t(Object(w.b)({tagPageId:q})):"taiExcel"===e&&t(Object(s.b)({tableId:q,constants:y,fileSheet:"nguyenLieuSheet",fileName:"nguyenLieuName",isDownloadAll:!0,datas:G}))}}),Object(J.c)("div",{className:"tabs-main",style:{marginTop:"10px"},children:[k&&Object(J.b)(Q,{pageDatas:G}),Object(J.b)("div",{className:"aside-main",children:Object(J.b)(C.a,{constants:y,actions:E,datas:G,loading:p,modalId:q,isEdit:F,isSelection:!0,pagination:!0,pageSize:v,onChange:function(e){t(Object(D.k)(e.pageSize))},expandable:{expandedRowRender:function(e){return Object(J.b)("div",{children:e.id})},expandRowByClick:!0},onCallbackDataSource:function(e){return Object(x.orderBy)(e,["tenNhomNguyenLieu","tenNguyenLieu"])},rowClassName:function(e){return(null===e||void 0===e?void 0:e.isDaSuDung)?"":"bg-gold-less"}})})]}),Object(J.b)(N.a,{})]})}}}]);