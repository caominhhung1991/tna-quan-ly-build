(this["webpackJsonpreact-antd-admin"]=this["webpackJsonpreact-antd-admin"]||[]).push([[59],{1113:function(e,t,n){"use strict";n.r(t);var i,a,d,o,r=n(13),h=n(7),l=n(33),c=n(0),u=n.n(c),s=n(48),m=n(202),b=n(415),g=n(201),T=n(413),f=n(158),v=n(271),p=n(6),O=n(794),j={chiTiet:{id:"chiTiet",name:"Chi ti\u1ebft",width:180,className:"text-small font-weight-bold",form:{type:"text-area"}},khachHang:{id:"khachHang",name:"Kh\xe1ch h\xe0ng",width:160,className:"text-small font-weight-bold",form:{type:"input"}},tongTien:{id:"tongTien",name:"T\u1ed5ng ti\u1ec1n",width:100,className:"text-small font-weight-bold",align:"right",form:{type:"input-number-format"},render:p.numberRender},chietKhau:{id:"chietKhau",name:"Chi\u1ebft kh\u1ea5u",width:80,className:"text-small",align:"right",form:{type:"input-number-format"},render:p.numberRender},phaiThu:{id:"phaiThu",name:"Ph\u1ea3i thu",width:90,className:"text-small",align:"right",form:{type:"input-number-format"},render:p.numberRender},chiTietThuTien:{id:"chiTietThuTien",name:"Chi ti\u1ebft thu ti\u1ec1n",width:90,className:"text-small",align:"center",children:[{id:"thuLan1",name:"Thu l\u1ea7n 1",width:80,className:"text-small font-weight-bold text-danger",align:"right",form:{type:"input-number-format"},render:p.numberRender},{id:"thuLan2",name:"Thu l\u1ea7n 2",width:80,className:"text-small font-weight-bold text-danger",align:"right",form:{type:"input-number-format"},render:p.numberRender},{id:"thuLan3",name:"Thu l\u1ea7n 3",width:80,className:"text-small font-weight-bold text-danger",align:"right",form:{type:"input-number-format"},render:p.numberRender},{id:"thuLan4",name:"Thu l\u1ea7n 4",width:80,className:"text-small font-weight-bold text-danger",align:"right",form:{type:"input-number-format"},render:p.numberRender}]},daThu:{id:"daThu",name:"\u0110\xe3 thu",width:90,className:"text-small font-weight-bold",align:"right",render:p.numberRender},khachHangConNo:{id:"khachHangConNo",name:"KH c\xf2n n\u1ee3",width:90,className:"text-small font-weight-bold text-danger",align:"right",render:p.numberRender},getTableColumns:function(){return[Object(h.a)(Object(h.a)({},p.constants.stt),{},{fixed:!1}),O.a.ngay,this.chiTiet,this.khachHang,this.tongTien,this.chietKhau,this.phaiThu,this.chiTietThuTien,this.daThu,this.khachHangConNo,p.constants.editRow]},getInputFields:function(){var e,t,n,i,a,d,o,r;return[O.a.ngay,this.chiTiet,this.khachHang,this.tongTien,this.chietKhau,null===(e=this.chiTietThuTien)||void 0===e||null===(t=e.children)||void 0===t?void 0:t[0],null===(n=this.chiTietThuTien)||void 0===n||null===(i=n.children)||void 0===i?void 0:i[1],null===(a=this.chiTietThuTien)||void 0===a||null===(d=a.children)||void 0===d?void 0:d[2],null===(o=this.chiTietThuTien)||void 0===o||null===(r=o.children)||void 0===r?void 0:r[3]]},getExcelFields:function(){var e,t,n,i,a,d,o,r;return[O.a.ngay,this.chiTiet,this.khachHang,this.tongTien,this.chietKhau,this.phaiThu,null===(e=this.chiTietThuTien)||void 0===e||null===(t=e.children)||void 0===t?void 0:t[0],null===(n=this.chiTietThuTien)||void 0===n||null===(i=n.children)||void 0===i?void 0:i[1],null===(a=this.chiTietThuTien)||void 0===a||null===(d=a.children)||void 0===d?void 0:d[2],null===(o=this.chiTietThuTien)||void 0===o||null===(r=o.children)||void 0===r?void 0:r[3],this.daThu,this.khachHangConNo]}},x=[null===(i=j.chiTietThuTien.children)||void 0===i?void 0:i[0],null===(a=j.chiTietThuTien.children)||void 0===a?void 0:a[1],null===(d=j.chiTietThuTien.children)||void 0===d?void 0:d[2],null===(o=j.chiTietThuTien.children)||void 0===o?void 0:o[3]],w=n(414),N=n(3),k=n.n(N),y=n(9),C=n(270),D=n(394),M=n(285),R=n(35),S=n(17),I=f.d.doanhThuOBDModal,H=function(e){var t,n,i=e.onAfterAddFinish,a=Object(C.a)({Instance:D.a,onPending:M.e,addSelectedId:M.a}),d=Object(s.b)(),o=Object(s.c)((function(e){return e.form})),r=o.modal,l=o.datas,c=Object(s.c)((function(e){return e.account})).accountData,m=null===c||void 0===c||null===(t=c.paths)||void 0===t||null===(n=t.doanhThuOBD)||void 0===n?void 0:n.edit,b=u.a.useMemo((function(){var e;return!!(null===r||void 0===r||null===(e=r[I])||void 0===e?void 0:e.open)}),[r[I]]);function T(){return(T=Object(y.a)(k.a.mark((function e(t,n){var o,r,l,c,u,s,b,T,f,v;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m){e.next=2;break}return e.abrupt("return",Object(R.h)());case 2:if(console.log(t,"currentData"),o=!0,r=n.ngay,l=Object(p.convertMomentToString)(j.getInputFields(),n),c=Object(h.a)(Object(h.a)({},t),n),u=c.tongTien,s=void 0===u?0:u,b=c.chietKhau,!(s-(void 0===b?0:b)<0)){e.next=10;break}return e.abrupt("return",Object(R.f)("T\u1ed5ng ti\u1ec1n tr\u1eeb chi\u1ebft kh\u1ea5u ph\u1ea3i l\u1edbn h\u01a1n ho\u1eb7c b\u1eb1ng 0"));case 10:if(!n||!r){e.next=26;break}if(null===t||void 0===t?void 0:t.id){e.next=21;break}return f=r.format("YYMM"),v=[f],e.next=16,d(a.onAddAsync({validatedValues:Object(h.a)(Object(h.a)({},l),{},{otherPath:v,yearMonthId:f})}));case 16:o=e.sent,null===i||void 0===i||i(null===(T=o)||void 0===T?void 0:T.id),o=Boolean(o),e.next=26;break;case 21:return e.t0=Boolean,e.next=24,d(a.onUpdateAsync({currentData:t,validatedValues:l}));case 24:e.t1=e.sent,o=(0,e.t0)(e.t1);case 26:o&&d(g.a({modalId:I}));case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(S.b)(p.MyModal,{form:!0,title:Object(S.b)("div",{children:"Doanh Thu Osac B\xecnh D\u01b0\u01a1ng"}),visible:b,onClose:function(){d(g.a({modalId:I}))},onOkModal:function(e,t){return T.apply(this,arguments)},formOptions:Object(p.getFormItemFields)(j.getInputFields()),formProps:{labelCol:{span:8},wrapperCol:{span:16}},width:700,modalId:I,datas:l})},B=n(66),K=n(75),P=function(e){var t=e.dateTimePicker,n=Object(s.b)();return Object(S.b)(S.a,{children:Object(S.b)(T.a,{header:Object(S.b)("div",{className:"font-weight-bold",children:Object(S.b)("span",{children:"Th\xf4ng Tin Trang "})}),body:Object(S.b)("div",{className:"form-input-aside",style:{padding:"5px"},children:Object(S.b)("div",{children:(null===t||void 0===t?void 0:t.getMonthRender())||null})}),footer:Object(S.b)("div",{children:Object(S.b)(B.a,{icon:Object(S.b)(K.a,{}),onClick:function(){n(Object(b.b)({tagPageId:f.d.doanhThuOBDModal}))},children:"\u0110\xf3ng m\u1edf r\u1ed9ng"})})})})},F=n(417),E=n(15),L=n(430),A=f.d.doanhThuOBDModal,z=Object(c.memo)((function(e){var t=e.pageData,n=Object(s.c)((function(e){return e.hideColumns})),i=null===n||void 0===n?void 0:n[A||""],a=u.a.useMemo((function(){var e,t,n,a,d,o,r,h,l=[f.a.stt,O.a.ngay,j.chiTiet,j.khachHang],c=[null===(e=j.chiTietThuTien)||void 0===e||null===(t=e.children)||void 0===t?void 0:t[0],null===(n=j.chiTietThuTien)||void 0===n||null===(a=n.children)||void 0===a?void 0:a[1],null===(d=j.chiTietThuTien)||void 0===d||null===(o=d.children)||void 0===o?void 0:o[2],null===(r=j.chiTietThuTien)||void 0===r||null===(h=r.children)||void 0===h?void 0:h[3]];return[{id:0,colSpan:2+l.reduce((function(e,t){var n=t.id;return e+((null===i||void 0===i?void 0:i[n])?0:1)}),0),cellClassName:"text-center font-weight-bold text-danger"},{id:1,colSpan:1,cellClassName:"text-right font-weight-bold text-small text-danger",render:function(e){return Object(p.formatNumber)(e)}},{id:2,colSpan:1,cellClassName:"text-right font-weight-bold text-small text-danger",render:function(e){return Object(p.formatNumber)(e)}},{id:3,colSpan:1,cellClassName:"text-right font-weight-bold text-small text-danger",render:function(e){return Object(p.formatNumber)(e)}},{id:4,colSpan:c.reduce((function(e,t){var n=t.id;return e+((null===i||void 0===i?void 0:i[n])?0:1)}),0)},{id:5,colSpan:1,cellClassName:"text-right font-weight-bold text-small text-danger",render:function(e){return Object(p.formatNumber)(e)}},{id:6,colSpan:1,cellClassName:"text-right font-weight-bold text-small text-danger",render:function(e){return Object(p.formatNumber)(e)}},{id:7,colSpan:1}]}),[i]),d=u.a.useMemo((function(){return t.reduce((function(e,t){var n=e.tongTien+(t.tongTien||0),i=e.chietKhau+(t.chietKhau||0),a=e.phaiThu+(t.phaiThu||0),d=e.daThu+(t.daThu||0),o=e.khachHangConNo+(t.khachHangConNo||0);return Object(h.a)(Object(h.a)({},e),{},{tongTien:n,chietKhau:i,phaiThu:a,daThu:d,khachHangConNo:o})}),{tong:"T\u1ed5ng ti\u1ec1n",tongTien:0,chietKhau:0,phaiThu:0,daThu:0,khachHangConNo:0})}),[t]),o=u.a.useMemo((function(){return["tong","tongTien","chietKhau","phaiThu","","daThu","khachHangConNo"].map((function(e,t){return Object(r.a)({},t,d[e])}))}),[d]);return Object(S.b)(L.a,{columns:a,dataSource:o})})),G=f.d.doanhThuOBDModal;t.default=function(){var e,t,n=Object(s.b)(),i=Object(s.c)((function(e){return e.doanhThuOBD})),a=i.tabsData,d=i.loading,o=i.pageSize,c=i.doanhThuOBDs,f=Object(s.c)((function(e){var t;return null===(t=e.tagsPage)||void 0===t?void 0:t[G]})),p=Object(s.c)((function(e){return e.account})).accountData,O=null===p||void 0===p||null===(e=p.paths)||void 0===e||null===(t=e.doanhThuOBD)||void 0===t?void 0:t.edit,N=Object(F.b)(),k=Object(l.a)(N,2),y=k[0],I=k[1],B=Object(C.a)({Instance:D.a,onPending:M.e,addSelectedId:M.a,isEdit:O});var K=u.a.useMemo((function(){return c?Object.values(c).reduce((function(e,t){var n=Math.round(((null===t||void 0===t?void 0:t.tongTien)||0)-((null===t||void 0===t?void 0:t.chietKhau)||0)),i=x.reduce((function(e,n){return e+((null===t||void 0===t?void 0:t[(null===n||void 0===n?void 0:n.id)||""])||0)}),0),a=Math.round(n-i);return Object(h.a)(Object(h.a)({},e),{},Object(r.a)({},t.id,Object(h.a)(Object(h.a)({},t),{},{daThu:i,phaiThu:n,khachHangConNo:a})))}),{}):{}}),[c]);return u.a.useEffect((function(){return n(Object(M.c)(y)),function(){Object(E.l)("doanhThuOBD")}}),[y]),Object(S.c)("div",{className:"doanhThuOBD-page",css:v.a,children:[Object(S.b)(T.b,{className:"tabs",options:a,activeKey:f?"aside":"",onTabClick:function(e){if("add"===e&&O){if(!O)return Object(R.h)();var t=new D.a;n(Object(g.c)({modalId:G,data:t.initData}))}else"aside"===e?n(Object(b.b)({tagPageId:G})):"taiExcel"===e&&n(Object(m.b)({tableId:G,constants:j,fileSheet:"doanhThuOBDSheet",fileName:"doanhThuOBDName"}))}}),Object(S.c)("div",{className:"tabs-main",style:{marginTop:"10px"},children:[f&&Object(S.b)(P,{dateTimePicker:I}),Object(S.b)("div",{className:"aside-main",children:Object(S.b)(w.a,{isEdit:O,constants:j,actions:B,datas:K,loading:d,modalId:G,expandable:{expandedRowRender:function(e){return Object(S.b)("div",{children:e.id})},expandRowByClick:!1},isSelection:!0,pagination:!0,pageSize:o,onChange:function(e){n(Object(M.f)(e.pageSize))},summary:function(e){return Object(S.b)(z,{pageData:e})}})})]}),Object(S.b)(H,{})]})}},794:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(6),a={tongDoanhThu:{id:"tongDoanhThu",name:"T\u1ed5ng doanh thu",width:130,className:"text-small font-weight-bold text-danger",align:"right",render:i.numberRender},ngay:{id:"ngay",name:"Ng\xe0y",width:80,className:"text-small font-weight-bold",align:"center",form:{type:"date-picker",rules:[{required:!0,message:"Ch\u01b0a nh\u1eadp"}]}},thu:{id:"thu",name:"Thu",width:100,className:"text-small font-weight-bold text-success",align:"right",form:{type:"input-number-format"},render:i.numberRender},chi:{id:"chi",name:"Chi",width:100,align:"right",className:"text-small font-weight-bold text-danger",form:{type:"input-number-format"},render:i.numberRender},conLai:{id:"conLai",name:"C\xf2n l\u1ea1i",width:100,align:"right",className:"text-small font-weight-bold",render:i.numberRender},dienGiai:{id:"dienGiai",name:"Di\u1ec5n gi\u1ea3i",width:200,className:"text-small",isSearch:!0,form:{type:"text-area"}},getTableColumns:function(){return[i.constants.stt,i.constants.active,i.constants.editRow]},getInputFields:function(){return[]},getExcelFields:function(){return[i.constants.active]}}}}]);