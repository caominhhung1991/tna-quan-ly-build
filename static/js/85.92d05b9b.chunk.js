(this["webpackJsonpreact-antd-admin"]=this["webpackJsonpreact-antd-admin"]||[]).push([[85],{1114:function(e,n,t){"use strict";t.r(n);var a=t(13),i=t(7),c=t(21),u=t(33),o=t(0),r=t.n(o),d=t(48),s=t(201),l=t(202),b=t(270),g=t(413),h=t(158),j=t(271),O=t(6),p=t(278),f=t(822),v=t(377),m=t(160),y={getTableColumns:function(){return[Object(i.a)(Object(i.a)({},O.constants.stt),{},{fixed:!1}),v.c.tenNguyenLieu,Object(i.a)(Object(i.a)({},p.a.tenDonViTinh),{},{align:"center"}),m.a.tenNhomNguyenLieu,Object(i.a)(Object(i.a)({},f.a.tenNhaCungCap),{},{fixed:!1,name:"T\xean NCC \u0111\u1eb7t h\xe0ng",width:150}),Object(i.a)(Object(i.a)({},v.c.giaNguyenLieu),{},{name:"Gi\xe1 \u0111\u1eb7t h\xe0ng"}),O.constants.active,O.constants.editRow]},getInputFields:function(){return[]},getExcelFields:function(){return[O.constants.id,v.c.tenNguyenLieu,p.a.tenDonViTinh,m.a.nhomNguyenLieuId,m.a.tenNhomNguyenLieu,f.a.nhaCungCapId,f.a.tenNhaCungCap,v.c.giaNguyenLieu]}},C=t(414),N=t(803),L=t(161),D=t(419),I=t(35),w=t(415),x=t(71),S=t(3),T=t.n(S),k=t(29),V=t(9),A=t(556),F=t(66),P=t(179),R=t(75),E=t(15),M=t(276),B=t(416),z=t(787),G=t(893),K=t(436),J=t(147);var Q=t(17),X=h.d.nguyenLieuModal,U=function(e){var n,t,o=e.pageDatas,s=Object(d.b)(),b=Object(d.c)((function(e){return e.account})).isDev,j=Object(d.c)((function(e){return e.diaDiem})),p=j.diaDiemId,f=j.diaDiems,v=Object(d.c)((function(e){return e.nhaCungCap})),m=v.nhaCungCapId,y=v.nhaCungCaps,C=Object(d.c)((function(e){return e.table})).selectedRows,N=Object(P.useForm)(),D=Object(u.a)(N,1)[0],w=r.a.useMemo((function(){return 0!==((null===C||void 0===C?void 0:C[X])||[]).length&&m}),[C,m]),x=Object(d.c)((function(e){return e.account})).accountData,S=null===x||void 0===x||null===(n=x.paths)||void 0===n||null===(t=n.danhSachNL)||void 0===t?void 0:t.edit;function U(){return(U=Object(V.a)(T.a.mark((function e(){var n,t,a,i,c,u,o,r,d;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(null===f||void 0===f?void 0:f[p])||{},t=n.tenDiaDiem,a=(null===y||void 0===y?void 0:y[m])||{},i=a.tenNhaCungCap,S){e.next=4;break}return e.abrupt("return",Object(I.h)());case 4:if(window.confirm("X\xe1c nh\u1eadn c\u1eadp nh\u1eadt c\xe1c nguy\xean li\xeau th\xe0nh nh\xe0 cung c\u1ea5p ".concat(i," \u0111ang \u0111\u1eb7t h\xe0ng t\u1ea1i \u0111\u1ecba \u0111i\u1ec3m ").concat(t))){e.next=6;break}return e.abrupt("return");case 6:Object(E.l)("giaNguyenLieuTheoDiaDiem"),c=(null===C||void 0===C?void 0:C[X])||[],u=Object(k.a)(c),e.prev=9,u.s();case 11:if((o=u.n()).done){e.next=20;break}return r=o.value,d={id:r.id,nhaCungCapId:m},e.next=16,s(Object(M.c)(d));case 16:d=e.sent,s(Object(K.h)(d,p));case 18:e.next=11;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(9),u.e(e.t0);case 25:return e.prev=25,u.f(),e.finish(25);case 28:s(Object(l.d)({tableId:X,selectedRowKeys:[],selectedRows:[]})),s(Object(K.d)(p)),Object(I.g)();case 31:case"end":return e.stop()}}),e,null,[[9,22,25,28]])})))).apply(this,arguments)}return r.a.useEffect((function(){s(Object(K.d)(p))}),[p]),r.a.useEffect((function(){var e=localStorage.getItem("nhaCungCapId")||"",n=localStorage.getItem("diaDiemId")||"";s(Object(M.a)(e)),s(Object(B.a)(n)),D.setFieldsValue({nhaCungCapId:e,diaDiemId:n})}),[]),Object(Q.b)(Q.a,{children:Object(Q.b)(g.a,{header:Object(Q.b)("div",{className:"font-weight-bold",children:Object(Q.b)("span",{children:"Th\xf4ng Tin Trang"})}),body:Object(Q.c)("div",{className:"form-input-aside",style:{padding:"5px"},children:[Object(Q.c)(A.a,{form:D,children:[Object(Q.b)(z.a,{isDanhSachNL:!0,onAfterSelect:function(e){D.setFieldsValue({nhaCungCapId:""}),s(Object(M.a)(""))}}),Object(Q.b)(G.a,{isAddNew:!0,isTrangQuanLy:!0,diaDiemId:p,onAfterAddFinish:function(e){D.setFieldsValue({nhaCungCapId:e})}})]}),Object(Q.b)("div",{style:{marginTop:"10px"},children:Object(Q.b)(F.a,{disabled:!w,type:"primary",onClick:function(){return U.apply(this,arguments)},children:"C\u1eadp nh\u1eadt nh\xe0 cung c\u1ea5p"})}),b&&Object(Q.b)("div",{style:{marginTop:"10px"},children:Object(Q.b)(F.a,{onClick:function(){s(function(){var e=Object(V.a)(T.a.mark((function e(n,t){var c,u,o,r,d,s,l;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t(),u=c.nguyenLieu.nguyenLieus,o=new J.a,r=o.nhomGiaMonAnPaths,e.next=6,Object(E.d)(r);case 6:return d=e.sent,s=Object.values(d).reduce((function(e,n){return Object.values(n).reduce((function(e,n){return n.reduce((function(e,n){var t,c=n.id,o=(null===u||void 0===u||null===(t=u[c])||void 0===t?void 0:t.tenNguyenLieu)||c;return Object(i.a)(Object(i.a)({},e),{},Object(a.a)({},c,o))}),e)}),e)}),{}),l=o.nguyenLieuDaSuDungPaths,e.next=11,n(Object(E.i)(l));case 11:return e.next=13,n(Object(E.n)(l,s));case 13:Object(O.thongBaoDaLuu)();case 14:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}())},children:"L\u01b0u NL \u0111\xe3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong m\xf3n \u0103n"})}),b&&Object(Q.b)("div",{style:{marginTop:"10px"},children:Object(Q.b)(F.a,{onClick:function(){s(function(e){return function(){var n=Object(V.a)(T.a.mark((function n(t,a){var i,u,o,r,d;return T.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=a(),(u=i.nguyenLieu).nguyenLieuDaSuDungs,o=u.nguyenLieus,console.log(Object.values(o)),r=Object.values(o||{}).map((function(e){var n,t=e.id,a=e.active,i=e.tenNguyenLieu,c=e.donViTinhId,u=e.tenDonViTinh,o=e.nhomNguyenLieuId,r=e.tenNhomNguyenLieu,d=i.toLowerCase();return(null===(n=d=d.split(""))||void 0===n?void 0:n[0])&&(d[0]=d[0].toUpperCase()),{id:t,active:a,tenNguyenLieu:d=d.join(""),donViTinhId:c,tenDonViTinh:u,nhomNguyenLieuId:o,tenNhomNguyenLieu:r}})),d=new L.a,Object.values(e).filter((function(e){return!(null===e||void 0===e?void 0:e.isDaSuDung)&&"giaVi"!==e.nhomNguyenLieuId&&"chiPhiKhac"!==e.nhomNguyenLieuId&&"dien"!==e.nhomNguyenLieuId&&"gas"!==e.nhomNguyenLieuId})),n.next=8,Promise.all(r.map((function(e){var n=[].concat(Object(c.a)(d.pathDatas),[e.id]);return Object(E.j)(n,e)})));case 8:Object(O.thongBaoDaLuu)();case 9:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()}(o))},children:"X\xf3a NL kh\xf4ng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong m\xf3n \u0103n"})})]}),footer:Object(Q.b)("div",{children:Object(Q.b)(F.a,{icon:Object(Q.b)(R.a,{}),onClick:function(){return s(Object(O.toggleAside)({tagPageId:h.d.nguyenLieuModal}))},children:"\u0110\xf3ng m\u1edf r\u1ed9ng"})})})})},q=h.d.nguyenLieuModal;n.default=function(){var e,n,t=Object(d.b)(),o=Object(d.c)((function(e){return e.nguyenLieu})),h=o.tabsData,p=o.loading,f=o.pageSize,v=o.nguyenLieus,m=o.nguyenLieuDaSuDungs,S=Object(d.c)((function(e){return e.nhaCungCap})).nhaCungCaps,T=Object(d.c)((function(e){return e.diaDiem})).diaDiemId,k=Object(d.c)((function(e){return e.danhSachGiaNL})).giaNguyenLieuTheoDiaDiemDatas,V=Object(d.c)((function(e){var n;return null===(n=e.tagsPage)||void 0===n?void 0:n[q]})),F=Object(d.c)((function(e){return e.account})).accountData,P=null===F||void 0===F||null===(e=F.paths)||void 0===e||null===(n=e.danhSachNL)||void 0===n?void 0:n.edit,R=A.a.useForm(),E=Object(u.a)(R,1)[0],B=Object(b.a)({Instance:L.a,onPending:D.i,addSelectedId:D.a,isEdit:P}),K=[O.constantTabs.moRong,{label:Object(Q.b)(A.a,{form:E,children:Object(Q.b)("div",{style:{width:220},children:Object(Q.b)(z.a,{isDanhSachNL:!0,onAfterSelect:function(e){E.setFieldsValue({nhaCungCapId:""}),t(Object(M.a)(""))}})})}),value:"diaDiemSelect"},{label:Object(Q.b)(A.a,{form:E,children:Object(Q.b)("div",{style:{width:220},children:Object(Q.b)(G.a,{isAddNew:!0,isTrangQuanLy:!0,diaDiemId:T,onAfterAddFinish:function(e){E.setFieldsValue({nhaCungCapId:e})}})})}),value:"nhaCungCapSelect"}].concat(Object(c.a)(h));var J=r.a.useMemo((function(){return Object.values(v).reduce((function(e,n){var t=n.id,c=!!(null===m||void 0===m?void 0:m[t]),u=(null===k||void 0===k?void 0:k[t])||{},o=u.tenNhaCungCap,r=u.nhaCungCapId,d=u.giaNguyenLieu;if(d&&!o){var s=(null===S||void 0===S?void 0:S[r])||{};console.log(n.tenNguyenLieu,r,s.tenNhaCungCap)}var l=Object(i.a)(Object(i.a)({},n),{},{nhaCungCapId:r,tenNhaCungCap:o,giaNguyenLieu:d,isDaSuDung:c});return Object(i.a)(Object(i.a)({},e),{},Object(a.a)({},t,l))}),{})}),[v,k,m]);return Object(Q.c)("div",{className:"nguyenLieu-page",css:j.a,children:[Object(Q.b)(g.b,{className:"tabs",options:K,activeKey:V?"aside":"",onTabClick:function(e){if("add"===e){if(!P)return Object(I.h)();var n=new L.a;t(Object(s.c)({modalId:q,data:n.initData}))}else"aside"===e?t(Object(w.b)({tagPageId:q})):"taiExcel"===e&&t(Object(l.b)({tableId:q,constants:y,fileSheet:"nguyenLieuSheet",fileName:"nguyenLieuName",isDownloadAll:!0,datas:J}))}}),Object(Q.c)("div",{className:"tabs-main",style:{marginTop:"10px"},children:[V&&Object(Q.b)(U,{pageDatas:J}),Object(Q.b)("div",{className:"aside-main",children:Object(Q.b)(C.a,{constants:y,actions:B,datas:J,loading:p,modalId:q,isEdit:P,isSelection:!0,pagination:!0,pageSize:f,onChange:function(e){t(Object(D.k)(e.pageSize))},expandable:{expandedRowRender:function(e){return Object(Q.b)("div",{children:e.id})},expandRowByClick:!0},onCallbackDataSource:function(e){return Object(x.orderBy)(e,["tenNhomNguyenLieu","tenNguyenLieu"])},rowClassName:function(e){return(null===e||void 0===e?void 0:e.isDaSuDung)?"":"bg-gold-less"}})})]}),Object(Q.b)(N.a,{})]})}}}]);