(this["webpackJsonpreact-antd-admin"]=this["webpackJsonpreact-antd-admin"]||[]).push([[86],{1110:function(n,e,a){"use strict";a.r(e);var t=a(3),c=a.n(t),i=a(8),r=a(9),u=a(33),d=a(0),o=a.n(d),l=a(48),b=a(559),s=a(66),h=a(410),O=a(332),j=a(201),p=a(158),f=a(272),g=a(503),v=a(416),m=a(186),N=a(271),C=a(444),L=a(422),y=a(577),D=a(75),I=a(415),S=a(417),k=a(21);var x=a(15),w=a(6),G=a(13),E=a(405);function M(n,e){var a=(n||{}).id,t=null===n||void 0===n?void 0:n[E.a.giaNguyenLieu.name];return Object(G.a)({id:a},e,t)}function B(n,e){return function(){var a=Object(r.a)(c.a.mark((function a(t,i){var r,u,d,o,l;return c.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=i(),u=r.importExcel.sheetJSONs,d=(null===u||void 0===u?void 0:u[p.d.importGiaNguyenLieuModal])||[],o=d.reduce((function(n,a){var t=M(a,e);return(null===t||void 0===t?void 0:t[e])?[].concat(Object(k.a)(n),[t]):n}),[]),l=new m.a,a.next=7,Promise.all(o.map((function(e){var a=[].concat(Object(k.a)(l.pathDatas),[n,e.id]);return t(Object(x.n)(a,e))})));case 7:return a.abrupt("return",null);case 8:case"end":return a.stop()}}),a)})));return function(n,e){return a.apply(this,arguments)}}()}var T=a(17),P=function(n){var e=n.getDanhSachGiaNLByDiaDiem,a=Object(l.b)(),t=Object(l.c)((function(n){return n.account})).isDev,i=Object(l.c)((function(n){return n.danhSachGiaNL})).isCapNhatGiaNL,u=Object(l.c)((function(n){return n.nhaCungCap})).nhaCungCapId,d=Object(l.c)((function(n){return n.diaDiem})).diaDiemId;return Object(T.c)(T.a,{children:[Object(T.b)(I.a,{header:Object(T.b)("div",{className:"font-weight-bold",children:Object(T.b)("span",{children:"Th\xf4ng Tin Trang"})}),body:Object(T.c)("div",{className:"form-input-aside",style:{padding:"5px"},children:[Object(T.b)(s.a,{block:!0,type:i?"primary":"dashed",onClick:function(){return a(Object(C.i)(!i))},children:"C\u1eadp nh\u1eadt gi\xe1"}),Object(T.b)("div",{className:"mt-1",children:Object(T.b)(s.a,{block:!0,icon:Object(T.b)(y.a,{}),onClick:function(){a(Object(w.openModal)({modalId:p.d.importGiaNguyenLieuModal}))},children:"Import Excel"})}),t&&Object(T.b)("div",{className:"mt-1",children:Object(T.b)("button",{onClick:function(){Object(x.k)(),a(function(){var n=Object(r.a)(c.a.mark((function n(e,a){var t,i,r,u;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=a(),i=t.danhSachGiaNL.giaNguyenLieus,r=new m.a,u=[].concat(Object(k.a)(r.pathDatas),["xuongDauGiay"]),Object.values(i).forEach((function(n,e){var a=n.id,t=n.nhaCungCapId,c=n.giaNguyenLieu;(void 0===c?0:c)!==((null===n||void 0===n?void 0:n[t])||0)&&([].concat(Object(k.a)(u),[a]),console.log(n))}));case 5:case"end":return n.stop()}}),n)})));return function(e,a){return n.apply(this,arguments)}}())},children:"C\u1eadp nh\u1eadt l\u1ea1i gi\xe1 NL \u0111\xe3 g\xe1n NCC"})}),t&&Object(T.b)("div",{className:"mt-1",children:Object(T.b)("button",{onClick:function(){Object(x.k)(),a(Object(C.g)())},children:"C\u1eadp nh\u1eadt l\u1ea1i NCC NL b\u1ecb sai"})})]}),footer:Object(T.b)("div",{children:Object(T.b)(s.a,{icon:Object(T.b)(D.a,{}),onClick:function(){a(Object(S.b)({tagPageId:p.d.danhSachGiaNLModal}))},children:"\u0110\xf3ng m\u1edf r\u1ed9ng"})})}),Object(T.b)(w.ImportExcelModal,{modalId:p.d.importGiaNguyenLieuModal,modalTitle:"Import Gi\xe1 Nguy\xean Li\u1ec7u T\u1eeb Excel",onFinishCapNhatDuLieu:Object(r.a)(c.a.mark((function n(){return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Object(x.k)(),n.next=3,a(B(d,u));case 3:console.log("finish"),Object(w.thongBaoDaLuu)(),null===e||void 0===e||e(d,u);case 6:case"end":return n.stop()}}),n)})))})]})},A=a(547),F=a(806),R=a(71),z=a(421),J=a(35),V=a(202),K=a(790),Q=a(936);var X=function(n){var e,a,t,c,i=n.modalId,r=Object(l.c)((function(n){return n.danhSachGiaNL})),u=r.tabsData,d=r.isCapNhatGiaNL,o=Object(l.c)((function(n){var e;return null===(e=n.tagsPage)||void 0===e?void 0:e[i]})),b=Object(l.c)((function(n){return n.account})).accountData,s=(null===b||void 0===b||null===(e=b.paths)||void 0===e||null===(a=e.danhSachGiaNL)||void 0===a?void 0:a.edit)&&d,h=null===b||void 0===b||null===(t=b.paths)||void 0===t||null===(c=t.danhSachNL)||void 0===c?void 0:c.edit,O=Object(l.c)((function(n){return n.diaDiem})).diaDiemId,j=Object(l.c)((function(n){return n.nhaCungCap}));return{tabsData:u,tagPage:o,isEdit:s,isEditNguyenLieu:h,diaDiemId:O,nhaCungCaps:j.nhaCungCaps,nhaCungCapId:j.nhaCungCapId,nguyenLieus:Object(l.c)((function(n){return n.nguyenLieu})).nguyenLieus}},q=a(179);var H=function(n){var e=n.modalId,a=n.getDanhSachGiaNLByDiaDiem,t=n.form,i=Object(l.b)(),u=X({modalId:e}),d=u.tabsData,s=u.tagPage,h=u.isEditNguyenLieu,O=u.diaDiemId,f=u.nhaCungCaps,v=u.nhaCungCapId,m=u.nguyenLieus,N=null===q.a||void 0===q.a?void 0:q.a.chiMotDiaDiem;o.a.useEffect((function(){var n=N?q.a.diaDiemId:localStorage.getItem("diaDiemId")||"",e=localStorage.getItem("nhaCungCapId")||null;n&&(null===a||void 0===a||a(n,e))}),[m,f]);var C=N?[]:[{label:Object(T.b)(b.a,{form:t,children:Object(T.b)("div",{style:{width:230},children:Object(T.b)(K.a,{isDanhSachNL:!0,onAfterSelect:function(){var n=Object(r.a)(c.a.mark((function n(e){return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i(Object(z.a)("")),n.next=3,a(e,v);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()})})}),value:"diaDiemSelect"}],L=[w.constantTabs.moRong].concat(C,[{label:Object(T.b)(b.a,{form:t,children:Object(T.b)("div",{style:{width:285},children:Object(T.b)(Q.a,{isAddNew:!0,isTrangQuanLy:!0,diaDiemId:O,onAfterSelect:function(){var n=Object(r.a)(c.a.mark((function n(e){return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a(O,e);case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()})})}),value:"nhaCungCapSelect"}],Object(k.a)(d));return Object(T.b)(I.b,{className:"tabs",options:L,activeKey:s?"aside":"",onTabClick:function(n){if("add"===n){if(!h)return Object(J.h)();i(Object(j.c)({modalId:p.d.nguyenLieuModal,data:{}}))}else"aside"===n?i(Object(S.b)({tagPageId:e})):"taiExcel"===n&&i(Object(V.b)({tableId:e,constants:g.a,fileSheet:"danhSachGiaNLSheet",fileName:"danhSachGiaNLName"}))}})},U=a(418),W=p.d.danhSachGiaNLModal;e.default=function(){var n,e,a,t,d=Object(l.b)(),o=b.a.useForm(),y=Object(u.a)(o,1)[0],D=Object(l.c)((function(n){return n.danhSachGiaNL})),I=D.loading,S=D.pageSize,k=D.danhSachGiaNLs,x=D.isCapNhatGiaNL,w=Object(l.c)((function(n){var e;return null===(e=n.tagsPage)||void 0===e?void 0:e[W]})),G=Object(l.c)((function(n){return n.diaDiem})).diaDiemId,E=Object(l.c)((function(n){return n.nhaCungCap})).nhaCungCapId,M=Object(l.c)((function(n){return n.account})).accountData,B=null===M||void 0===M||null===(n=M.paths)||void 0===n||null===(e=n.danhSachGiaNL)||void 0===e?void 0:e.edit,J=(null===M||void 0===M||null===(a=M.paths)||void 0===a||null===(t=a.danhSachGiaNL)||void 0===t?void 0:t.edit)&&x,V=Object(N.a)({Instance:m.a,onPending:C.e,addSelectedId:C.a,isEdit:J});function K(n,e){return Q.apply(this,arguments)}function Q(){return(Q=Object(r.a)(c.a.mark((function n(e,a){return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=9;break}return y.setFieldsValue({diaDiemId:e}),y.setFieldsValue({nhaCungCapId:a}),d(Object(z.a)(a)),d(Object(U.a)(e)),n.next=7,d(Object(C.c)(e,a));case 7:n.next=10;break;case 9:d(Object(C.j)({}));case 10:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return Object(T.c)("div",{className:"danhSachGiaNL-page",css:f.a,children:[Object(T.b)(H,{modalId:W,getDanhSachGiaNLByDiaDiem:K,form:y,isEditNguyenLieu:B}),Object(T.c)("div",{className:"tabs-main",style:{marginTop:"10px"},children:[w&&Object(T.b)(P,{getDanhSachGiaNLByDiaDiem:K}),Object(T.b)("div",{className:"aside-main",children:Object(T.b)(v.a,{isEdit:J,constants:g.a,actions:V,datas:k,loading:I,modalId:W,isSelection:!0,pagination:!0,pageSize:S,onChange:function(n){d(Object(C.k)(n.pageSize))},inputOptions:{isEdit:J},onBlur:function(n){var e=n.target.value;e=Object(A.a)(e),e=Number(e),d(Object(C.f)(G,E,n.target.name,e))},onCallbackDataSource:function(n){return Object(R.orderBy)(n,["tenNhomNguyenLieu","tenNguyenLieu"])},expandable:{rowExpandable:function(){return B},expandedRowRender:function(n){return Object(T.c)("div",{children:[Object(T.c)("div",{children:[Object(T.b)(s.a,{style:{marginRight:"5px"},icon:Object(T.b)(O.a,{}),onClick:function(){B&&d(Object(j.c)({modalId:p.d.nguyenLieuModal,data:n}))},children:"C\u1eadp nh\u1eadt"}),Object(T.b)(h.a,{checkedChildren:"\u1ea8n nguy\xean li\u1ec7u",unCheckedChildren:"B\u1ecf \u1ea9n nguy\xean li\u1ec7u",checked:n.active,onClick:function(){if(!window.confirm("X\xe1c nh\u1eadn \u1ea9n nguy\xean li\u1ec7u ".concat(n.tenNguyenLieu,"?")))return null;d(Object(L.c)(n))}}),Object(T.b)(s.a,{style:{marginLeft:"5px"},onClick:Object(r.a)(c.a.mark((function e(){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Object(i.a)(Object(i.a)({},n),{},{nhaCungCapId:E}),a=d(Object(z.c)(a)),d(Object(C.h)(a,G));case 3:case"end":return e.stop()}}),e)}))),children:"B\u1ea5m ch\u1ecdn \u0111\u1ec3 l\u01b0u \u0111\u1eb7t h\xe0ng"})]}),Object(T.c)("div",{className:"mt-1",children:["M\xe3 NL: ",n.id]})]})}}})})]}),Object(T.b)(F.a,{onAfterAddFinish:function(){K(G,E)}})]})}}}]);